<?xml version="1.0" encoding="UTF-8"?>
<database name="crabwalk_database">
  <description>
    Database schema generated by Crabwalk. This schema represents the structure of tables
    derived from SQL transformations, including dependencies and relationships.
  </description>
  <!-- Tables derived from SQL transformations -->
  <schema name="transform">
    <description>Tables generated by Crabwalk transformations</description>
    <table name="customers">
      <description>Generated from examples/jaffle_shop/marts/customers.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="stg_customers" type="transformation"/>
        <dependency table="stg_orders" type="transformation"/>
        <dependency table="customer_orders_summary" type="transformation"/>
        <dependency table="orders" type="transformation"/>
        <dependency table="joined" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="locations">
      <description>Generated from examples/jaffle_shop/marts/locations.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="stg_locations" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="order_items">
      <description>Generated from examples/jaffle_shop/marts/order_items.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="joined" type="transformation"/>
        <dependency table="stg_supplies" type="transformation"/>
        <dependency table="stg_orders" type="transformation"/>
        <dependency table="order_supplies_summary" type="transformation"/>
        <dependency table="stg_products" type="transformation"/>
        <dependency table="products" type="transformation"/>
        <dependency table="stg_order_items" type="transformation"/>
        <dependency table="orders" type="transformation"/>
        <dependency table="supplies" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="orders">
      <description>Generated from examples/jaffle_shop/marts/orders.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="compute_booleans" type="transformation"/>
        <dependency table="order_items_cte" type="transformation"/>
        <dependency table="customer_order_count" type="transformation"/>
        <dependency table="order_items_summary" type="transformation"/>
        <dependency table="stg_orders" type="transformation"/>
        <dependency table="order_items" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="products">
      <description>Generated from examples/jaffle_shop/marts/products.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="stg_products" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_customers">
      <description>Generated from examples/jaffle_shop/sources/raw_customers.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_items">
      <description>Generated from examples/jaffle_shop/sources/raw_items.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_orders">
      <description>Generated from examples/jaffle_shop/sources/raw_orders.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_payments">
      <description>Generated from examples/jaffle_shop/seeds/raw_payments.sql</description>
      <column name="id" type="numeric" primary_key="true">
        <description>Derived from: Value(Number("1", false))</description>
      </column>
      <column name="order_id" type="numeric">
        <description>Derived from: Value(Number("1", false))</description>
      </column>
      <column name="payment_method" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="amount" type="numeric">
        <description>Derived from: Value(Number("10", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("2", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("2", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("20", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("3", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("3", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("coupon"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("30", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("4", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("4", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("bank_transfer"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("40", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("5", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("5", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("50", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("6", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("6", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("60", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("7", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("7", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("coupon"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("70", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("8", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("8", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("80", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("9", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("9", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("bank_transfer"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("90", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("10", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("10", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("bank_transfer"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("100", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("11", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("11", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("110", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("12", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("12", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("120", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("13", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("13", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("credit_card"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("130", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("14", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("14", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("coupon"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("140", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("15", false))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("15", false))</description>
      </column>
      <column name="literal" type="string">
        <description>Derived from: Value(SingleQuotedString("bank_transfer"))</description>
      </column>
      <column name="literal" type="numeric">
        <description>Derived from: Value(Number("150", false))</description>
      </column>
    </table>
    <table name="raw_products">
      <description>Generated from examples/jaffle_shop/sources/raw_products.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_stores">
      <description>Generated from examples/jaffle_shop/sources/raw_stores.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="raw_supplies">
      <description>Generated from examples/jaffle_shop/sources/raw_supplies.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="read_csv" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_customers">
      <description>Generated from examples/jaffle_shop/staging/stg_customers.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="renamed" type="transformation"/>
        <dependency table="source" type="transformation"/>
        <dependency table="raw_customers" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_locations">
      <description>Generated from examples/jaffle_shop/staging/stg_locations.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="raw_stores" type="transformation"/>
        <dependency table="renamed" type="transformation"/>
        <dependency table="source" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_order_items">
      <description>Generated from examples/jaffle_shop/staging/stg_order_items.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="source" type="transformation"/>
        <dependency table="raw_items" type="transformation"/>
        <dependency table="renamed" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_orders">
      <description>Generated from examples/jaffle_shop/staging/stg_orders.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="renamed" type="transformation"/>
        <dependency table="raw_orders" type="transformation"/>
        <dependency table="source" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_products">
      <description>Generated from examples/jaffle_shop/staging/stg_products.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="raw_products" type="transformation"/>
        <dependency table="renamed" type="transformation"/>
        <dependency table="source" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_supplies">
      <description>Generated from examples/jaffle_shop/staging/stg_supplies.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="renamed" type="transformation"/>
        <dependency table="raw_supplies" type="transformation"/>
        <dependency table="source" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="supplies">
      <description>Generated from examples/jaffle_shop/marts/supplies.sql</description>
      <column name="*" type="unknown" primary_key="true">
        <description>Column from query</description>
      </column>
      <source_dependencies>
        <dependency table="stg_supplies" type="transformation"/>
      </source_dependencies>
    </table>
  </schema>
  <!-- Entity-Relationship Diagram -->
  <entity_relationships>
    <relationship type="references" name="supplies_to_stg_supplies">
      <from table="transform.supplies" column="id"/>
      <to table="transform.stg_supplies" column="id"/>
      <description>supplies depends on stg_supplies</description>
    </relationship>
    <relationship type="references" name="stg_order_items_to_raw_items">
      <from table="transform.stg_order_items" column="id"/>
      <to table="transform.raw_items" column="id"/>
      <description>stg_order_items depends on raw_items</description>
    </relationship>
    <relationship type="references" name="order_items_to_stg_supplies">
      <from table="transform.order_items" column="id"/>
      <to table="transform.stg_supplies" column="id"/>
      <description>order_items depends on stg_supplies</description>
    </relationship>
    <relationship type="references" name="order_items_to_stg_orders">
      <from table="transform.order_items" column="id"/>
      <to table="transform.stg_orders" column="id"/>
      <description>order_items depends on stg_orders</description>
    </relationship>
    <relationship type="references" name="order_items_to_stg_products">
      <from table="transform.order_items" column="id"/>
      <to table="transform.stg_products" column="id"/>
      <description>order_items depends on stg_products</description>
    </relationship>
    <relationship type="references" name="order_items_to_products">
      <from table="transform.order_items" column="id"/>
      <to table="transform.products" column="id"/>
      <description>order_items depends on products</description>
    </relationship>
    <relationship type="references" name="order_items_to_stg_order_items">
      <from table="transform.order_items" column="id"/>
      <to table="transform.stg_order_items" column="id"/>
      <description>order_items depends on stg_order_items</description>
    </relationship>
    <relationship type="references" name="order_items_to_orders">
      <from table="transform.order_items" column="id"/>
      <to table="transform.orders" column="id"/>
      <description>order_items depends on orders</description>
    </relationship>
    <relationship type="references" name="order_items_to_supplies">
      <from table="transform.order_items" column="id"/>
      <to table="transform.supplies" column="id"/>
      <description>order_items depends on supplies</description>
    </relationship>
    <relationship type="references" name="stg_orders_to_raw_orders">
      <from table="transform.stg_orders" column="id"/>
      <to table="transform.raw_orders" column="id"/>
      <description>stg_orders depends on raw_orders</description>
    </relationship>
    <relationship type="references" name="locations_to_stg_locations">
      <from table="transform.locations" column="id"/>
      <to table="transform.stg_locations" column="id"/>
      <description>locations depends on stg_locations</description>
    </relationship>
    <relationship type="references" name="stg_products_to_raw_products">
      <from table="transform.stg_products" column="id"/>
      <to table="transform.raw_products" column="id"/>
      <description>stg_products depends on raw_products</description>
    </relationship>
    <relationship type="references" name="stg_customers_to_raw_customers">
      <from table="transform.stg_customers" column="id"/>
      <to table="transform.raw_customers" column="id"/>
      <description>stg_customers depends on raw_customers</description>
    </relationship>
    <relationship type="references" name="customers_to_stg_customers">
      <from table="transform.customers" column="id"/>
      <to table="transform.stg_customers" column="id"/>
      <description>customers depends on stg_customers</description>
    </relationship>
    <relationship type="references" name="customers_to_stg_orders">
      <from table="transform.customers" column="id"/>
      <to table="transform.stg_orders" column="id"/>
      <description>customers depends on stg_orders</description>
    </relationship>
    <relationship type="references" name="customers_to_orders">
      <from table="transform.customers" column="id"/>
      <to table="transform.orders" column="id"/>
      <description>customers depends on orders</description>
    </relationship>
    <relationship type="references" name="stg_supplies_to_raw_supplies">
      <from table="transform.stg_supplies" column="id"/>
      <to table="transform.raw_supplies" column="id"/>
      <description>stg_supplies depends on raw_supplies</description>
    </relationship>
    <relationship type="references" name="stg_locations_to_raw_stores">
      <from table="transform.stg_locations" column="id"/>
      <to table="transform.raw_stores" column="id"/>
      <description>stg_locations depends on raw_stores</description>
    </relationship>
    <relationship type="references" name="products_to_stg_products">
      <from table="transform.products" column="id"/>
      <to table="transform.stg_products" column="id"/>
      <description>products depends on stg_products</description>
    </relationship>
    <relationship type="references" name="orders_to_stg_orders">
      <from table="transform.orders" column="id"/>
      <to table="transform.stg_orders" column="id"/>
      <description>orders depends on stg_orders</description>
    </relationship>
    <relationship type="references" name="orders_to_order_items">
      <from table="transform.orders" column="id"/>
      <to table="transform.order_items" column="id"/>
      <description>orders depends on order_items</description>
    </relationship>
  </entity_relationships>
  <!-- Data Lineage -->
  <data_lineage>
    <transformation name="sql_transformations">
      <description>SQL-based data transformations executed by Crabwalk</description>
      <steps>
        <step from="multiple" to="transform.supplies">
          <sources>
            <source>stg_supplies</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_order_items">
          <sources>
            <source>source</source>
            <source>raw_items</source>
            <source>renamed</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.order_items">
          <sources>
            <source>joined</source>
            <source>stg_supplies</source>
            <source>stg_orders</source>
            <source>order_supplies_summary</source>
            <source>stg_products</source>
            <source>products</source>
            <source>stg_order_items</source>
            <source>orders</source>
            <source>supplies</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_orders">
          <sources>
            <source>renamed</source>
            <source>raw_orders</source>
            <source>source</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.locations">
          <sources>
            <source>stg_locations</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_orders">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_products">
          <sources>
            <source>raw_products</source>
            <source>renamed</source>
            <source>source</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_products">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_customers">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_items">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_customers">
          <sources>
            <source>renamed</source>
            <source>source</source>
            <source>raw_customers</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.customers">
          <sources>
            <source>stg_customers</source>
            <source>stg_orders</source>
            <source>customer_orders_summary</source>
            <source>orders</source>
            <source>joined</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_supplies">
          <sources>
            <source>renamed</source>
            <source>raw_supplies</source>
            <source>source</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.stg_locations">
          <sources>
            <source>raw_stores</source>
            <source>renamed</source>
            <source>source</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_stores">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.raw_supplies">
          <sources>
            <source>read_csv</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.products">
          <sources>
            <source>stg_products</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.orders">
          <sources>
            <source>compute_booleans</source>
            <source>order_items_cte</source>
            <source>customer_order_count</source>
            <source>order_items_summary</source>
            <source>stg_orders</source>
            <source>order_items</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="source" to="transform.raw_payments">
          <operations>
            <operation>Source data load</operation>
          </operations>
        </step>
      </steps>
    </transformation>
  </data_lineage>
</database>