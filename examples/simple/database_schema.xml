<?xml version="1.0" encoding="UTF-8"?>
<database name="crabwalk_database">
  <description>
    Database schema generated by Crabwalk. This schema represents the structure of tables
    derived from SQL transformations, including dependencies and relationships.
  </description>
  <!-- Tables derived from SQL transformations -->
  <schema name="transform">
    <description>Tables generated by Crabwalk transformations</description>
    <table name="customer_orders">
      <description>Generated from ./examples/simple/tmp/customer_orders.sql</description>
      <column name="id" type="unknown" primary_key="true">
        <description>Primary key (automatically inferred)</description>
      </column>
      <source_dependencies>
        <dependency table="stg_customers" type="transformation"/>
        <dependency table="stg_orders" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="order_summary">
      <description>Generated from ./examples/simple/tmp/order_summary.sql</description>
      <column name="id" type="unknown" primary_key="true">
        <description>Primary key (automatically inferred)</description>
      </column>
      <source_dependencies>
        <dependency table="stg_orders" type="transformation"/>
      </source_dependencies>
    </table>
    <table name="stg_customers">
      <description>Generated from ./examples/simple/tmp/stg_customers.sql</description>
      <column name="id" type="unknown" primary_key="true">
        <description>Primary key (automatically inferred)</description>
      </column>
    </table>
    <table name="stg_orders">
      <description>Generated from ./examples/simple/tmp/stg_orders.sql</description>
      <column name="id" type="unknown" primary_key="true">
        <description>Primary key (automatically inferred)</description>
      </column>
    </table>
  </schema>
  <!-- Entity-Relationship Diagram -->
  <entity_relationships>
    <relationship type="references" name="customer_orders_to_stg_customers">
      <from table="transform.customer_orders" column="id"/>
      <to table="transform.stg_customers" column="id"/>
      <description>customer_orders depends on stg_customers</description>
    </relationship>
    <relationship type="references" name="customer_orders_to_stg_orders">
      <from table="transform.customer_orders" column="id"/>
      <to table="transform.stg_orders" column="id"/>
      <description>customer_orders depends on stg_orders</description>
    </relationship>
    <relationship type="references" name="order_summary_to_stg_orders">
      <from table="transform.order_summary" column="id"/>
      <to table="transform.stg_orders" column="id"/>
      <description>order_summary depends on stg_orders</description>
    </relationship>
  </entity_relationships>
  <!-- Data Lineage -->
  <data_lineage>
    <transformation name="sql_transformations">
      <description>SQL-based data transformations executed by Crabwalk</description>
      <steps>
        <step from="multiple" to="transform.customer_orders">
          <sources>
            <source>stg_customers</source>
            <source>stg_orders</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="source" to="transform.stg_orders">
          <operations>
            <operation>Source data load</operation>
          </operations>
        </step>
        <step from="multiple" to="transform.order_summary">
          <sources>
            <source>stg_orders</source>
          </sources>
          <operations>
            <operation>SQL transformation</operation>
          </operations>
        </step>
        <step from="source" to="transform.stg_customers">
          <operations>
            <operation>Source data load</operation>
          </operations>
        </step>
      </steps>
    </transformation>
  </data_lineage>
</database>